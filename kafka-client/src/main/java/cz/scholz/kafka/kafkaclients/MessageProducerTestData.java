package cz.scholz.kafka.kafkaclients;

import cz.scholz.kafka.kafkaclients.util.RandomStringGenerator;
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.clients.producer.ProducerRecord;
import org.apache.kafka.clients.producer.RecordMetadata;

import java.util.Date;
import java.util.Properties;
import java.util.concurrent.ExecutionException;

public class MessageProducerTestData {
    private static int count = 50;
    private static int timeTick = 1000;
    private static int messageSize = 1024;

    private static Boolean debug = false;

    public static void main(String[] args) throws ExecutionException, InterruptedException {
        System.setProperty("org.slf4j.simpleLogger.defaultLogLevel", "info");
        System.setProperty("org.slf4j.simpleLogger.showThreadName", "false");

        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:9092");
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, "org.apache.kafka.common.serialization.StringSerializer");

        KafkaProducer<String, String> producer = new KafkaProducer<String, String>(props);

        /*producer.send(new ProducerRecord<String, String>("dbserver1.inventory.customer",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.customer.Key\"},\"payload\":{\"id\":1}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"first_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"last_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"twitter_handle\"}],\"optional\":true,\"name\":\"dbserver1.inventory.customer.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"first_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"last_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"twitter_handle\"}],\"optional\":true,\"name\":\"dbserver1.inventory.customer.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.customer.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":1,\"first_name\":\"alain\",\"last_name\":\"pham\",\"twitter_handle\":\"@koint\"},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"customer\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.customer",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.customer.Key\"},\"payload\":{\"id\":2}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"first_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"last_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"twitter_handle\"}],\"optional\":true,\"name\":\"dbserver1.inventory.customer.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"first_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"last_name\"},{\"type\":\"string\",\"optional\":true,\"field\":\"twitter_handle\"}],\"optional\":true,\"name\":\"dbserver1.inventory.customer.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.customer.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":2,\"first_name\":\"laurent\",\"last_name\":\"broudoux\",\"twitter_handle\":\"@lbroudoux\"},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"customer\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));

        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":1}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":1,\"main_actor\":\"Jessica Lange\",\"title\":\"King Kong\",\"year\":1976},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":2}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":2,\"main_actor\":\"Chuck Norris\",\"title\":\"Delta Force\",\"year\":1986},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":3}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":3,\"main_actor\":\"Anthony Hopkins\",\"title\":\"The Elephant Man\",\"year\":1980},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":4}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":4,\"main_actor\":\"Chuck Norris\",\"title\":\"Invasion U.S.A.\",\"year\":1985},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":5}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":5,\"main_actor\":\"Chuck Norris\",\"title\":\"An Eye for an Eye\",\"year\":1981},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":6}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":6,\"main_actor\":\"Roger Miller\",\"title\":\"Robin Hood\",\"year\":1973},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":7}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":7,\"main_actor\":\"Charles Chaplin\",\"title\":\"Charly Chaplin in Wien\",\"year\":1931},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":8}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":8,\"main_actor\":\"Chuck Norris\",\"title\":\"The Octagon\",\"year\":1980},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.movie",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Key\"},\"payload\":{\"id\":9}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"string\",\"optional\":true,\"field\":\"main_actor\"},{\"type\":\"string\",\"optional\":true,\"field\":\"title\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"year\"}],\"optional\":true,\"name\":\"dbserver1.inventory.movie.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.movie.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":9,\"main_actor\":\"James Stewart\",\"title\":\"Vertigo\",\"year\":1958},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"movie\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        */

        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":1}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":1,\"rental_duration\":7,\"start_date\":1558085147000,\"customer_id\":2,\"movie_id\":6},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":2}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":2,\"rental_duration\":7,\"start_date\":1558085647000,\"customer_id\":2,\"movie_id\":9},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":3}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":3,\"rental_duration\":7,\"start_date\":1558086405000,\"customer_id\":2,\"movie_id\":7},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":4}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":4,\"rental_duration\":7,\"start_date\":1558093022000,\"customer_id\":2,\"movie_id\":3},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":5}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":5,\"rental_duration\":7,\"start_date\":1558093278000,\"customer_id\":1,\"movie_id\":1},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":6}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":6,\"rental_duration\":7,\"start_date\":1558093309000,\"customer_id\":1,\"movie_id\":3},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":7}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":7,\"rental_duration\":7,\"start_date\":1558093842000,\"customer_id\":1,\"movie_id\":6},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":0,\"ts_sec\":0,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":7943,\"row\":0,\"snapshot\":true,\"thread\":null,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558097283698}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":8}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":8,\"rental_duration\":7,\"start_date\":1558108932000,\"customer_id\":2,\"movie_id\":5},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":223344,\"ts_sec\":1558108932,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":8144,\"row\":0,\"snapshot\":false,\"thread\":149,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558108932218}}"));
        producer.send(new ProducerRecord<String, String>("dbserver1.inventory.rental",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Key\"},\"payload\":{\"id\":10}}",
                "{\"schema\":{\"type\":\"struct\",\"fields\":[{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"before\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"int64\",\"optional\":false,\"field\":\"id\"},{\"type\":\"int32\",\"optional\":true,\"field\":\"rental_duration\"},{\"type\":\"int64\",\"optional\":true,\"name\":\"io.debezium.time.Timestamp\",\"version\":1,\"field\":\"start_date\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"customer_id\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"movie_id\"}],\"optional\":true,\"name\":\"dbserver1.inventory.rental.Value\",\"field\":\"after\"},{\"type\":\"struct\",\"fields\":[{\"type\":\"string\",\"optional\":true,\"field\":\"version\"},{\"type\":\"string\",\"optional\":true,\"field\":\"connector\"},{\"type\":\"string\",\"optional\":false,\"field\":\"name\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"server_id\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"ts_sec\"},{\"type\":\"string\",\"optional\":true,\"field\":\"gtid\"},{\"type\":\"string\",\"optional\":false,\"field\":\"file\"},{\"type\":\"int64\",\"optional\":false,\"field\":\"pos\"},{\"type\":\"int32\",\"optional\":false,\"field\":\"row\"},{\"type\":\"boolean\",\"optional\":true,\"default\":false,\"field\":\"snapshot\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"thread\"},{\"type\":\"string\",\"optional\":true,\"field\":\"db\"},{\"type\":\"string\",\"optional\":true,\"field\":\"table\"},{\"type\":\"string\",\"optional\":true,\"field\":\"query\"}],\"optional\":false,\"name\":\"io.debezium.connector.mysql.Source\",\"field\":\"source\"},{\"type\":\"string\",\"optional\":false,\"field\":\"op\"},{\"type\":\"int64\",\"optional\":true,\"field\":\"ts_ms\"}],\"optional\":false,\"name\":\"dbserver1.inventory.rental.Envelope\"},\"payload\":{\"before\":null,\"after\":{\"id\":10,\"rental_duration\":7,\"start_date\":1558108932000,\"customer_id\":2,\"movie_id\":2},\"source\":{\"version\":\"0.9.5.Final\",\"connector\":\"mysql\",\"name\":\"dbserver1\",\"server_id\":223344,\"ts_sec\":1558108932,\"gtid\":null,\"file\":\"mysql-bin.000003\",\"pos\":8144,\"row\":0,\"snapshot\":false,\"thread\":149,\"db\":\"inventory\",\"table\":\"rental\",\"query\":null},\"op\":\"c\",\"ts_ms\":1558108932218}}"));

        producer.close();
    }


}